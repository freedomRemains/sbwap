---
# h2データベースを使用するための設定について

[TOPに戻る](../README.md)

「build.gradle」にh2を使用するための設定記述が必要。

```
[build.gradle]

	// h2DBを使用するための設定
	runtimeOnly 'com.h2database:h2'
```

「application.properties」に、データソースの設定が必要。

```
[application.properties]

## datasource settings
spring.datasource.url=jdbc:h2:~/test
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:dbinit/schema.sql 
spring.sql.init.data-locations=classpath:dbinit/data.sql 
```
- 「spring.sql.init.mode=always」を指定すると、SpringBoot起動時に  
  必ず毎回初期化SQLを実行してオンメモリのDBスキーマを作成する。  
  (簡易動作確認に便利なやり方)
- 「spring.sql.init.schema-locations」でDB構築SQL、  
  「spring.sql.init.data-locations」でDB初期化SQLを指定できる。  
  前者はDROP-CREATEのSQLを記述する。(SpringBoot起動時、毎回DB初期化する)  
  後者は初期データ投入のSQLを記述する。

また「application.properties」に次の設定を追加することで、  
ブラウザからh2のコンソールにアクセスできるようになる。

```
[application.properties]

## h2 settings
spring.h2.console.enabled=true
```
SpringBootを起動すると、コンソールに次のような表示が出る。
```
[SpringBoot起動時のコンソール表示]

[ログ時刻やクラス名] H2 console available at '/h2-console'. Database available at 'jdbc:h2:~/test'
```
- ブラウザを開き、次のURLにアクセスする。  
  http://localhost:8080/h2-console
- 「JDBC URL」の項に上記コンソールに表示されている「jdbc:h2:~/test」の部分を入力する。
- 「Connect」(日本語表示なら「接続」　)をクリックし、ログインできればアクセスに成功している。  
  SELECTを実行すると、投入されている初期データを確認できる。
